# Análisis de regresión lineal simple usando R

La regresión lineal es una técnica estadística utilizada para modelar la relación entre una variable dependiente (*respuesta*) y una o más variables independientes (*predictoras*). Este análisis permite predecir valores, evaluar relaciones y entender cómo las variables están conectadas.

En esta sección, se exploran dos tipos de regresión:

1.  **Regresión lineal simple**: Relación entre una variable dependiente y una sola variable independiente.

2.  **Regresión lineal múltiple**: Relación entre una variable dependiente y múltiples variables independientes.

## Preparación del área de trabajo

Instalación y carga de los paquetes necesarios para desarrollar esta sección

```{r message=FALSE, warning=FALSE}
# Instalación y carga de paquetes  
 # Incluye ggplot2, dplyr, tidyr
if (!require("tidyverse")) install.packages("tidyverse")

 # Se utiliza para leer archivos excel
if (!require("readxl")) install.packages("readxl")

 # Se utiliza para evaluar el supuesto de homosedasticidad
if (!require("car")) install.packages("car")

```

## Carga de datos

[Datos ciprés](https://docs.google.com/spreadsheets/d/1ko4CJC8AiSz5W5XYDsWx2xZgPIU3QXyU/edit?usp=sharing&ouid=106152052819657144907&rtpof=true&sd=true)

El código para cargar los datos es el siguiente:

```{r}
# Importar un archivo Excel
cipres <- read_excel("cipres.co.xlsx",
                          sheet = "Hoja1", 
                          col_names = TRUE)

```

Posteriormente, se realiza una exploración inicial de los datos para comprender su estructura y contenido:

Para visualizar las primeras filas:

```{r}

# Visualizar los primeros registros del data frame
head(cipres)
```

Las variables principales del conjunto de datos son:

1.  `altura`: Altura de los arboles en pies.

2.  `diametro`: Diámetro de los arboles en cm

3.  `volumen`: Volumen de los arboles en metros cúbicos. (revisar unidades de medida)

## **Exploración inicial de los datos**

Antes de ajustar un modelo de regresión, se realiza un análisis descriptivo para identificar patrones iniciales en las variables.

### **Gráfico de dispersión entre altura y volumen**

```{r}
# Elaboración de un gráfico de dispersión entre altura y volumen
ggplot(data = cipres, aes(x = altura, y = volumen)) +
  geom_point(color = "black", size = 2) +
  labs(title = "Relación altura - volumen",
       x = "Altura (pies)",
       y = "Volumen (m^3)")+
  theme_minimal()+
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12, face = "bold"),
    axis.text.x = element_text( hjust = 1, size = 10),
    plot.caption = element_text(hjust = 0, size = 8, color = "gray50")
  )

```

Este gráfico permite observar una relación positiva entre altura y peso, donde a mayor altura, el peso tiende a ser mayor.

### **Gráfico de dispersión entre diámetro y volumen**

```{r}
# Elaboración de un gráfico de dispersión entre diámetro y volumen
ggplot(data = cipres, aes(x = diametro, y = volumen)) +
  geom_point(color = "black", size = 2) +
  labs(title = "Relación altura - volumen",
       x = "Altura (pies)",
       y = "Volumen (m^3)")+
  theme_minimal()+
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12, face = "bold"),
    axis.text.x = element_text( hjust = 1, size = 10),
    plot.caption = element_text(hjust = 0, size = 8, color = "gray50")
  )

```

## **Regresión lineal simple**

La regresión lineal simple se utiliza para modelar la relación entre una variable dependiente (`peso`) y una variable independiente (`altura`).

### **Ajuste del modelo**

```{r}
regsimple<-lm(cipres$volumen~cipres$diametro)
summary(regsimple)
```

### **Interpretación de los resultados**

### **Visualización de la línea de regresión**

```{r message=FALSE, warning=FALSE}
plot(cipres$diametro,cipres$volumen)
abline(regsimple, fitted.values=cipres$volumen, col="blue", lwd=2)

```

### **Verificación de supuestos del modelo**

La regresión lineal simple asume:

1.  Linealidad entre las variables.

2.  Normalidad de los residuos.

3.  Homocedasticidad (varianza constante de los residuos).

#### **Gráficos diagnósticos**

```{r}
par(mfrow=c(1,2))
plot(regsimple,which=1:2)
par(mfrow=c(1,1))  # Restaura la configuración gráfica

```

#### **Pruebas estadísticas**

Para evaluar la normalidad de los residuos:

```{r}
shapiro.test(resid(regsimple))
```

Interpretacion: no cumple con el supuesto de normalidad

Para evaluar la homocedasticidad:

```{r message=FALSE, warning=FALSE}

ncvTest(regsimple)
```

Interpretacion: no cumple con el supuesto de homocedasticidad

### Transformacion de variables

```{r}
# grafico de dispersion datos transformados
plot(log(cipres$diametro),log(cipres$volumen))

```

### Calcular un modelo con log en Y e X

log(volumen)= a + b\*Log(diametro) + e

```{r}
# Regresion usando logaritmos
reg<-lm(log(cipres$volumen)~log(cipres$diametro))
summary(reg)
```

#### Revisión de supuestos

La regresión lineal simple asume:

1.  Linealidad entre las variables.

2.  Normalidad de los residuos.

3.  Homocedasticidad (varianza constante de los residuos).

#### **Gráficos diagnósticos**

```{r}
par(mfrow=c(1,2)) 
plot(reg,which=1:2) 
par(mfrow=c(1,1))  # Restaura la configuración gráfica 
```

#### **Pruebas estadísticas**

Para evaluar la normalidad de los residuos:

```{r}
shapiro.test(resid(reg))
```

Interpretacion: no cumple con el supuesto de normalidad

Para evaluar la homocedasticidad:

```{r message=FALSE, warning=FALSE}
ncvTest(reg)
```

Interpretacion: no cumple con el supuesto de homocedasticidad

#### Línea de regresión 

```{r}
plot(log(cipres$diametro),log(cipres$volumen)) 
abline(reg, cipres$volumen, col="red", lwd=2)


```
